"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const hardhat_1 = require("hardhat");
const js_sha3_1 = require("js-sha3");
const func = async function (hre) {
    const { getNamedAccounts, deployments, network } = hre;
    const { deployer, owner } = await getNamedAccounts();
    if (!network.tags.use_root) {
        return true;
    }
    const root = await hardhat_1.ethers.getContract('Root');
    const registrar = await hardhat_1.ethers.getContract('BaseRegistrarImplementation');
    console.log('Running base registrar setup');
    const tx1 = await registrar.transferOwnership(owner, { from: deployer });
    console.log(`Transferring ownership of registrar to owner (tx: ${tx1.hash})...`);
    await tx1.wait();
    const tx2 = await root
        .connect(await hardhat_1.ethers.getSigner(owner))
        .setSubnodeOwner('0x' + (0, js_sha3_1.keccak256)('eth'), registrar.address);
    console.log(`Setting owner of eth node to registrar on root (tx: ${tx2.hash})...`);
    await tx2.wait();
};
func.id = 'setupRegistrar';
func.tags = ['setupRegistrar'];
//Runs after the root is setup
func.dependencies = ['setupRoot'];
exports.default = func;
